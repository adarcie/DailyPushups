<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Daily Pushups Counter</title>
  <style>
    html, body { margin: 0; padding: 0; height: 100%; }
    body { display: flex; align-items: center; justify-content: center; background: #2ecc71; color: white; font-family: sans-serif; flex-direction: column; }
    #dayCounter { font-size: 3vw; margin-bottom: 1vh; }
    #counter { font-size: 6vw; font-weight: bold; }
    #buttons, #incTab { display: flex; gap: 1vw; margin-top: 2vh; }
    button { font-size: 3vw; padding: 1vh 2vw; border: none; border-radius: 0.5vw; }
    #incTab { flex-direction: column; align-items: center; }
    #incControls { display: none; flex-direction: row; gap: 1vw; margin-top: 1vh; }
    .grey-bg { background-color: #bdc3c7; color: black; }
  </style>
</head>
<body>
  <div id="dayCounter">Day: 1</div>
  <div id="counter">15</div>
  <div id="buttons">
    <button id="dec10">-10</button>
    <button id="dec5">-5</button>
    <button id="dec1">-1</button>
  </div>
  <div id="incTab">
    <button id="toggleInc">+&hellip;</button>
    <button id="debugDay">Next Day</button>
    <div id="incControls">
      <button id="inc1">+1</button>
      <button id="inc5">+5</button>
      <button id="inc10">+10</button>
    </div>
  </div>
  <script>
    // Helpers
    function addDays(dateStr, days) {
      const d = new Date(dateStr);
      d.setDate(d.getDate() + days);
      return d.toISOString().split('T')[0];
    }
    // Load or initialize state
    let stored = JSON.parse(localStorage.getItem('pushupState') || 'null');
    const today = new Date().toISOString().split('T')[0];
    if (!stored) {
      stored = { start: 15, count: 15, lastDate: today, day: 1 };
    } else {
      // rollover for missed days
      if (stored.lastDate < today) {
        const daysMissed = Math.floor((new Date(today) - new Date(stored.lastDate)) / 864e5);
        for (let i = 0; i < daysMissed; i++) {
          stored.day += 1;
          const prevCount = stored.count;
          const newStart = stored.start + 1 + prevCount;
          stored.start = newStart;
          stored.count = newStart;
          stored.lastDate = addDays(stored.lastDate, 1);
        }
        localStorage.setItem('pushupState', JSON.stringify(stored));
      }
    }
    let current = stored.count;
    // UI elements
    const dayCounter = document.getElementById('dayCounter');
    const counter = document.getElementById('counter');
    const dec10 = document.getElementById('dec10');
    const dec5 = document.getElementById('dec5');
    const dec1 = document.getElementById('dec1');
    const inc1 = document.getElementById('inc1');
    const inc5 = document.getElementById('inc5');
    const inc10 = document.getElementById('inc10');
    const toggleInc = document.getElementById('toggleInc');
    const debugDay = document.getElementById('debugDay');
    const incControls = document.getElementById('incControls');
    // Display update
    function updateDisplay() {
      counter.textContent = current;
      dayCounter.textContent = 'Day: ' + stored.day;
      if (current <= 0) {
        document.body.classList.add('grey-bg');
      } else {
        document.body.classList.remove('grey-bg');
      }
    }
    function saveState() {
      stored.count = current;
      localStorage.setItem('pushupState', JSON.stringify(stored));
    }
    // Rollover (debug)
    function rolloverOneDay() {
      stored.day += 1;
      const prevCount = stored.count;
      const newStart = stored.start + 1 + prevCount;
      stored.start = newStart;
      stored.count = newStart;
      current = newStart;
      stored.lastDate = today; // for debug, treat as new today
      saveState();
      updateDisplay();
    }
    // Handlers
    dec10.onclick = () => { current = Math.max(0, current - 10); updateDisplay(); saveState(); };
    dec5.onclick = () => { current = Math.max(0, current - 5); updateDisplay(); saveState(); };
    dec1.onclick = () => { current = Math.max(0, current - 1); updateDisplay(); saveState(); };
    inc1.onclick = () => { current += 1; updateDisplay(); saveState(); };
    inc5.onclick = () => { current += 5; updateDisplay(); saveState(); };
    inc10.onclick = () => { current += 10; updateDisplay(); saveState(); };
    toggleInc.onclick = () => {
      incControls.style.display = incControls.style.display === 'flex' ? 'none' : 'flex';
    };
    debugDay.onclick = () => rolloverOneDay();
    // Init
    updateDisplay();
  </script>
</body>
</html>
